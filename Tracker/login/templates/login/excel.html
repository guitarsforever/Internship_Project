{% extends 'base.html' %}

{% block head %}
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
    $(document).ready(function() {
  $("#btnExport").click(function(e) {
    e.preventDefault();

    //getting data from our table
    var data_type = 'data:application/vnd.ms-excel';
    var table_div = document.getElementById('table_wrapper');
    var table_html = table_div.outerHTML.replace(/ /g, '%20');

    var a = document.createElement('a');
    a.href = data_type + ', ' + table_html;
    a.download = 'exported_table_' + Math.floor((Math.random() * 9999999) + 1000000) + '.xls';
    a.click();
  });
});

</script>
{% endblock %}

{%block content%}

<ul class="nav navbar-nav">
    <li><a href="/login/summary/">HA/HE</a></li>
</ul>

<ul class="nav navbar-nav">
    <li><a href="/general/">Mobile</a></li>
</ul>

<ul class="nav navbar-nav">
    <li><a href="/others/">Other Projects</a></li>
</ul>

{% endblock %}

{% block body %}
<div class ="container">
 <button id="btnExport">Export to xls</button>
  <br />
  <br />
  <div id="table_wrapper">
    <table border="1" cellspacing="0" bordercolor="#222" id="list">
      <tbody>
        <tr class="header">
							<th>Product Description</th>
							<th>Project</th>
							<th>Target Launch Date</th>
							<th>Overall% Ready</th>
							<th>Product Type</th>
							<th>Product Readiness</th>
                            <th>.com - Video Content</th>
							<th>.com - Digital Content</th>
							<th>Call Center Training</th>
							<th>Call Center Operations</th>
							<th>Product Support</th>
							<th>Warehouse - QC</th>
							<th>Field Service</th>
                            <th>Tech Support</th>
							<th>Service Marketing</th>
							<th>Service Training</th>
							<th>Parts</th>
        </tr>
        {% for Device in Device %}
        {% if Device.Archive == False %}
        <tr>
							<th onclick="location.href='/login/excel/{{Device.id}}'"
                            style="cursor:pointer">{{Device.ProductDescription}}</th>
							<th onclick="location.href='/login/excel/{{Device.id}}'"
                            style="cursor:pointer">{{Device.Name}}</th>
							<th onclick="location.href='/login/excel/{{Device.id}}'"
                            style="cursor:pointer">{{Device.LaunchDate|date:"m-d-y"}}</th>
							<th onclick="location.href='/login/excel/{{Device.id}}'"
                            style="cursor:pointer">{{Device.completed}}</th>
							<th onclick="location.href='/login/excel/{{Device.id}}'"
                            style="cursor:pointer">{{Device.Device_Category}}</th>
                            {% if Device.ProductReadiness.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.ProductReadiness.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.ProductReadiness.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.VideoContent.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.VideoContent.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.VideoContent.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.DigitalContent.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.DigitalContent.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.DigitalContent.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.CallCenterTraining.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.CallCenterTraining.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.CallCenterTraining.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.CallCenterOpertaions.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.CallCenterOpertaions.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.CallCenterOpertaions.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.ProductSupport.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.ProductSupport.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.ProductSupport.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.Warehouse.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.Warehouse.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.Warehouse.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.FieldService.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.FieldService.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.FieldService.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.TechSupport.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.TechSupport.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.TechSupport.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.ServiceMarketing.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.ServiceMarketing.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.ServiceMarketing.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.ServiceTraining.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.ServiceTraining.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.ServiceTraining.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th>
                            {% endif %}

                            {% if Device.Parts.completed == 100 %}
							<th><font color="green">Completed</font></th>
                            {% elif Device.Parts.Status == "At Risk"%}
                            <th><font color="orange">At Risk</font></th>
                            {% elif Device.Parts.Status == "Delayed"%}
                            <th><font color="red">Delayed</font></th>
                            {% else %}
                            <th><font color="blue">On Time</font></th> 
                            {% endif %}
        </tr>
        {% endif %}
        {% endfor%}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}